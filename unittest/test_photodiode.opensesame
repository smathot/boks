# Generated by OpenSesame 0.27.1~pre1 (Frisky Freud)
# Sun Feb 10 17:43:32 2013 (posix)
# <http://www.cogsci.nl/opensesame>

set foreground "white"
set subject_parity "even"
set font_size "18"
set description "Part of unittest"
set title "Photodiode Boks test"
set compensation "0"
set font_bold "no"
set coordinates "relative"
set height "768"
set mouse_backend "xpyriment"
set width "1024"
set sampler_backend "legacy"
set font_family "mono"
set keyboard_backend "legacy"
set background "black"
set subject_nr "0"
set canvas_backend "xpyriment"
set start "inline_script"
set synth_backend "legacy"
set font_italic "no"

define inline_script inline_script
	___run__
	from openexp.canvas import canvas
	import numpy as np
	
	if not hasattr(exp, 'boks'):
		raise Exception('Please run this experiment using the unittest script')
	
	cIns = canvas(exp)
	cIns.text('Hold the photodiode to the top-left of the display and press a button')
	cIns.show()
	exp.boks.set_continuous(False)
	exp.boks.set_buttons(None)
	exp.boks.get_button_press()
		
	c1 = canvas(exp)
	c2 = canvas(exp, bgcolor='white')
	exp.boks.set_continuous(True)
	exp.boks.set_buttons([8])
	exp.results = np.zeros(exp.N)
	for i in range(exp.N):	
		c1.show()
		self.sleep(200)
		t1 = c2.show()
		button, t2 = exp.boks.get_button_press()
		exp.results[i] = t2-t1
	__end__
	set _prepare ""
	set description "Executes Python code"

